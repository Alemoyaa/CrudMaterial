<button mat-flat-button color="primary" (click)="openModal(template)">Nueva Persona</button>

<div class="mat-elevation-z8" >
  <table mat-table [dataSource]="dataSource">

    <ng-container matColumnDef="id">
      <th mat-header-cell *matHeaderCellDef> id </th>
      <td mat-cell *matCellDef="let element"> {{element.id}} </td>
    </ng-container>

    <ng-container matColumnDef="nombre">
      <th mat-header-cell *matHeaderCellDef> Nombre </th>
      <td mat-cell *matCellDef="let element"> {{element.nombre}} </td>
    </ng-container>

    <ng-container matColumnDef="apellido">
      <th mat-header-cell *matHeaderCellDef> Apellido </th>
      <td mat-cell *matCellDef="let element"> {{element.apellido}} </td>
    </ng-container>

    <ng-container matColumnDef="dni">
      <th mat-header-cell *matHeaderCellDef> Dni </th>
      <td mat-cell *matCellDef="let element"> {{element.dni}} </td>
    </ng-container>

    <ng-container matColumnDef="acciones">
      <th mat-header-cell *matHeaderCellDef> Acciones </th>
      <td mat-cell *matCellDef="let element">
        <button mat-flat-button color="primary" (click)="delete(element.id)">Eliminar</button>
        <button mat-flat-button color="warn" (click)="cargarDatosFormulario(element)" (click)="openModal(template)" id="ml">Editar</button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

  </table>

  <mat-paginator
      [length]="this.personas.length"
      [pageIndex]="0"
      [pageSize]="5"
      [pageSizeOptions]="[5, 10, 20, 25]"
      showFirstLastButtons>
  </mat-paginator>

</div>

<ng-template #template>

  <h1 mat-dialog-title>Agregar Nueva Persona </h1>

  <form mat-dialog-content [formGroup]="formularioPersona">
    <p>Ingrese los datos de la persona</p>

    <mat-form-field>
      <mat-label>Nombre</mat-label>
      <input matInput formControlName="nombre">
      <mat-error  *ngIf="formularioPersona.controls['nombre'].invalid && formularioPersona.controls['nombre'].dirty"
          role="alert">
          <span *ngIf="formularioPersona.controls['nombre'].errors.required">El nombre es requerido</span>
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-label>Apellido</mat-label>
      <input matInput formControlName="apellido">
      <mat-error  *ngIf="formularioPersona.controls['apellido'].invalid && formularioPersona.controls['apellido'].dirty"
            role="alert">
            <span *ngIf="formularioPersona.controls['apellido'].errors.required">El apellido es requerido</span>
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-label>Dni</mat-label>
      <input matInput formControlName="dni">
      <mat-error  *ngIf="formularioPersona.controls['dni'].invalid && formularioPersona.controls['dni'].dirty"
            role="alert">
            <span *ngIf="formularioPersona.controls['dni'].errors.required">El dni es requerido</span>
            <span *ngIf="formularioPersona.controls['dni'].errors.pattern">El dni solo puede contener numeros</span>
      </mat-error>
    </mat-form-field>

  </form>

  <div mat-dialog-actions>
    <button *ngIf="!edicion" mat-button cdkFocusInitial (click)="agregar()"
    [disabled]="formularioPersona.controls['dni'].invalid || formularioPersona.controls['apellido'].invalid || formularioPersona.controls['nombre'].invalid">
    Agregar</button>
    <button *ngIf="edicion" mat-button  (click)="update()"
    [disabled]="formularioPersona.controls['dni'].invalid || formularioPersona.controls['apellido'].invalid || formularioPersona.controls['nombre'].invalid">
    Editar</button>
    <button mat-button mat-stroked-button (click)="closeModal()">Cancelar</button>
  </div>

</ng-template>
